---
title: Docker Compose
---

# Docker Compose

_(Updated: 29/08/2023)_

*From July 2023 Compose V1 stopped receiving updates. It's also no longer available in new releases of Docker Desktop. Compose V2 is included with all currently supported versions of Docker Desktop. The key difference that you need to have in mind right now is that Compose V2 uses the `docker compose` syntax instead of `docker-compose` that is used in Compose V1. *

## What is Docker Compose

Docker Compose is a tool that allows you to define and manage multi-container Docker applications using a simple YAML file ( `.yml` ). It simplifies the process of defining, configuring, and running multiple containers that work together as a single application stack. Docker Compose is particularly useful for orchestrating complex applications that consist of multiple interconnected services.

Here's an overview of how Docker Compose works and its key features:

1. **Application Definition**: With Docker Compose, you define your application's services, networks, and volumes in a single **docker-compose.yml** file. This file describes the structure of your application, including the different containers, their configurations, and how they interact.

2. **Services: Each container** within your application is represented as a "service" in the **docker-compose.yml** file. A service can be a web server, a database, a caching service, or any other component needed for your application. Services can be built from Docker images or pulled from registries.

3. **Networks**: Docker Compose automatically creates a default network for your application, allowing the containers to communicate with each other using their service names as DNS addresses. You can also define custom networks for more complex networking scenarios.

4. **Volumes**: Volumes are used to persist data generated by containers. Docker Compose allows you to define named volumes, which can be mounted to containers to store and share data across container restarts.

5. **Environment Variables and Configuration**: Docker Compose allows you to define environment variables and configuration options for each service. This makes it easy to customize the behavior of your containers without modifying the Dockerfiles.

6. **Container Links**: Containers defined in a Docker Compose file can communicate with each other directly, using the service names as hostnames.

7. **Dependency Management**: Docker Compose automatically starts and stops containers in the correct order based on their dependencies. This ensures that containers that rely on other services are only started once those services are up and running.

8. **Single Command Deployment**: Once you've defined your **docker-compose.yml** file, you can use a single command (**docker compose up**) to start all the services defined in the file. Similarly, you can use **docker compose down** to stop and remove the containers, networks, and volumes.

9. **Scaling Services**: Docker Compose also allows you to scale services by specifying the desired number of container instances. This can be useful for load balancing or other scenarios where you need to run multiple instances of a service.

10. **Integration with Docker Swarm**: While Docker Compose is primarily designed for single-host applications, it can also be used in conjunction with Docker Swarm mode to deploy multi-node applications across a cluster of machines.

Below you can find an example of a YAML configuration file that can be used by `docker compose` to start the specified services:

```yaml
version: '3'
services:
  # Node.js application service
  web:
    image: node:14  # Use the official Node.js 14 image
    working_dir: /app
    volumes:
      - .:/app       # Mount the current directory into the container
    ports:
      - "3000:3000"  # Expose port 3000 on the host
    environment:
      NODE_ENV: development
    command: npm start

  # MongoDB service
  db:
    image: mongo:latest  # Use the official MongoDB image
    ports:
      - "27017:27017"  # Expose port 27017 on the host
    volumes:
      - mongodb_data:/data/db  # Mount a volume for persistent data storage

volumes:
  mongodb_data:  # Named volume for MongoDB data
```

In this example:

- The **version: '3'** indicates the Docker Compose version being used.
- The **web** service is defined for the Node.js application:
    - It uses the official Node.js 14 image.
    - The working directory is set to `/app` inside the container.
    - The current directory (where the `docker-compose.yml` file is located) is mounted into the container to enable live code changes without rebuilding the image.
    - Port 3000 is exposed on both the container and the host machine.
    - An environment variable `NODE_ENV` is set to `development`.
    - The command `npm start` is used to start the Node.js application.
- The **db** service is defined for the MongoDB database:
    - It uses the official MongoDB image.
    - Port 27017 is exposed on both the container and the host machine.
    - A volume named `mongodb_data` is defined to store MongoDB data persistently.
- The **volumes** section defines the named volume mongodb_data for MongoDB's persistent storage.

### Sources and Attributions

- [Docker Compose](https://docs.docker.com/compose/){:target="_blank"}